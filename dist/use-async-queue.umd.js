!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("next-tick")):"function"==typeof define&&define.amd?define(["react","next-tick"],e):n.useAsyncQueue=e(n.react,n.nextTick)}(this,function(n,e){return e=e&&e.hasOwnProperty("default")?e.default:e,function(t){var u=t.done,r=t.drain,i=t.inflight,c=t.concurrency;(c=c||Infinity)<1&&(c=Infinity);var s=n.useState({numPending:0,numInFlight:0,numDone:0}),f=s[0],o=s[1],a=n.useRef(!0),g=n.useRef([]),d=n.useRef([]);return n.useEffect(function(){if(f.numDone>0&&r&&0===g.current.length&&0===d.current.length&&!a.current)return a.current=!0,e(r);for(var n=function(){a.current=!1;var n=d.current.shift();if(n){g.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),i&&i(Object.assign({},n,{stats:f}));var e=n.task();e.then(function(){g.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:e,stats:f}))}).catch(function(){g.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:e,stats:f}))})}};g.current.length<c&&d.current.length>0;)n()},[c,u,r,i,f]),{add:n.useCallback(function(n){d.current.find(function(e){return e.id===n.id})||(d.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending+1})}))},[]),stats:f}}});
//# sourceMappingURL=use-async-queue.umd.js.map
