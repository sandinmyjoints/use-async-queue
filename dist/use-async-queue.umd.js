!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("next-tick")):"function"==typeof define&&define.amd?define(["react","next-tick"],t):n.useAsyncQueue=t(n.react,n.nextTick)}(this,function(n,t){return t=t&&t.hasOwnProperty("default")?t.default:t,function(e){var u=e.done,r=e.drain,i=e.inflight,c=e.concurrency;(c=c||Infinity)<1&&(c=Infinity);var s=n.useState({numPending:0,numInFlight:0,numDone:0}),f=s[0],o=s[1],a=n.useRef(!0),d=n.useRef([]),g=n.useRef([]);return n.useEffect(function(){if(f.numDone>0&&r&&0===d.current.length&&0===g.current.length&&!a.current)return a.current=!0,t(r);for(var n=function(){a.current=!1;var n=g.current.shift();if(n){d.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),i&&i(Object.assign({},n,{stats:f}));var t=n.task();t.then(function(){d.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:t,stats:f}))}).catch(function(){d.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:t,stats:f}))})}};d.current.length<c&&g.current.length>0;)n()},[c,u,r,i,f]),{add:n.useCallback(function(n){g.current.find(function(t){return t.id===n.id})||d.current.find(function(t){return t.id===n.id})||(g.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending+1})}))},[]),stats:f}}});
//# sourceMappingURL=use-async-queue.umd.js.map
